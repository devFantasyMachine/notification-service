<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        
        <title> Home </title>

        <!-- JQuery -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    </head>
    <body>
    <h1> Home </h1>


    <a href="{% url 'notifications-test' %}" target="_blank"><button>Click Here to open notifications test page</button></a>
     

    

 

<!-- Notification Web Socket -->
    <script>
    var loc = window.location
    var wsStart = "ws://"
    if (loc.protocol == "https:"){
        wsStart = "wss://"
    }
    var webSocketEndpoint =  "wss://" + "proxy.yowyob.com/NOTIFICATION-SERVICE/listen-notification" + '?access_token=eyJraWQiOiI0OWNlNjNjYS1lMjcwLTQwOWMtYTU0Yi1mMjBkMDRlOWJmMjIiLCJhbGciOiJSUzI1NiJ9.eyJkZXZpY2VUeXBlIjoiVU5LTk9XTiIsInN1YiI6Ijk5Y2M1MDY4LTExYzktNGVhOC04YWFhLTc3Y2Y5YWU5OWZiMCIsImF1ZCI6IkluZmluaXggU01BUlQgNyBIRC1YNjUxNi1TRTY2OFNBQkNELVNHby1HTC0yMzA3MjFWNjM3IiwibmJmIjoxNjk3NjUxMTYxLCJyb2xlcyI6WyJQT0xMRVIiLCJVU0VSIiwiTEVUU0dPX1VTRVIiLCJEUklWRVIiXSwiaXNzIjoiaHR0cDovLzg4LjE5OC4xNTAuMTk1OjgwOTkvQVVUSC1TRVJWSUNFIiwiZXhwIjoxNzAwMjQzMTYxLCJpYXQiOjE2OTc2NTExNjEsImRldmljZUlkIjoiSW5maW5peCBTTUFSVCA3IEhELVg2NTE2LVNFNjY4U0FCQ0QtU0dvLUdMLTIzMDcyMVY2MzcifQ.EFL9SpNiQXo0BpAWwdAu5NX2cSPBq1s5kztTfudANUvio8J8JRpT7X9P5Ga5rKVfN_FBXUw03VWovVadXLIEzkRanAab8NE50QGAvvyBzK5Roe7YSaOT-jUtuMWXidXx05j66pVEEuanuFqXCc6wyugAdDbyeVaBvKfVhU_V1rn4S3RMOEjNvM1ylmlkDD9DHQ4x98Uz2iGWTX758KOKkC3GCf63Jen6NzLe4s9NEklq-21G-yDpsoEF2AOHmCe7qbPwHHDiRmiaVuW0O-mXE-GvYU5thx56BXkh6VU6T7cVwKxhuj-1vGywhY20FEYSlKXXz9XFGt6GCL2wKr-LbA&tenantId=LETSGO'
    // ws : wss   // Websocket URL, Same on as mentioned in the routing.py

    //webSocketEndpoint =  wsStart + "127.0.0.1:6066" + '/listen-notification?access_token=a&tenantId=LETSGO'

    var socket = new WebSocket(webSocketEndpoint) // Creating a new Web Socket Connection

    // Socket On receive message Functionality
    socket.onmessage = function(e){
        console.log('message', e)

        console.log(e.data) // Access the notification data
        $("body").append("<h3>"+e.data+"</h3>")
        // Can write any functionality based on your requirement

    }

    // Socket Connet Functionality
    socket.onopen = function(e){
        console.log('open', e)
        //socket.send("{ \"timestamp\": \"2023-02-12T23:23:12\", \"destinationId\": \"moi\", \"tenantId\": \"n\", \"content\": \"hello\" }")
    }

    // Socket Error Functionality
    socket.onerror = function(e){
        console.log('error', e)
    }

    // Socket close Functionality
    socket.onclose = function(e){
        console.log('closed', e)
    }
    </script>


    </body>
</html>
